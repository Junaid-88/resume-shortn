<!DOCTYPE html>
<html>
<head>
    <title>Resume Shortner</title>
</head>
<body>
    <h1>Resume Shortner</h1>
    <p>Upload your PDF resume to convert into single page format</p>
    
    <form id="uploadForm" enctype="multipart/form-data">
        <input type="file" name="resume" accept=".pdf" required>
        <br><br>
        <button type="submit">Shorten Resume</button>
    </form>
    
    <div id="result" style="margin-top: 20px;"></div>

    <script>
        // Get the current domain or fallback to localhost for development
        const API_URL = window.location.hostname === 'localhost' 
            ? 'http://localhost:5000'
            : 'https://resume-shortner.onrender.com/';  // Replace with your Render URL
            
        document.getElementById('uploadForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const resultDiv = document.getElementById('result');
            
            resultDiv.innerHTML = '<p>Processing with AI... Please wait.</p>';
            
            try {
                const response = await fetch(`${API_URL}/convert`, {
                    method: 'POST',
                    body: formData
                });
                
                if (response.ok) {
                    const blob = await response.blob();
                    const url = URL.createObjectURL(blob);
                    
                    resultDiv.innerHTML = `
                        <h3>Converted Resume:</h3>
                        <embed src="${url}" type="application/pdf" width="100%" height="600px">
                        <br><br>
                        <a href="${url}" download="converted_resume.pdf">
                            <button>Download PDF</button>
                        </a>
                    `;
                } else {
                    const error = await response.text();
                    resultDiv.innerHTML = `<p>Error: ${error}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p>Error: ${error.message}</p>`;
            }
        });
    </script>
</body>
</html>